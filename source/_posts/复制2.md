---
title: 作用域
date: 2017-11-01 08:36:30
tags:
---


# 定义
    变量的作用范围(有效范围)。
  
    
# 作用范围

## 全局变量
    定义:    在代码的任何地方都可以访问的变量，称之为全局变量。
    生命周期:    从定义开始，到页面被关闭结束。
    
## 局部变量
    定义:    只能在代码局部进行访问的变量，称之为局部变量。
    生命周期:    从定义开始，到函数执行完毕结束。不过有特殊情况可以让局部变量的生命周期延长,如:

```javascript
function getFn() {
    // 这个a的生命周期，和下面的函数进行了一个绑定，
    // 只有下面的函数消亡了，a才会消亡，否则一直存在。
    var a = 0;
    /*
     * 因为这个函数，对外面的局部变量a产生了依赖，
     * 所以js解析引擎在执行完毕getFn函数之后，
     * 不会回收局部变量a，以让这个函数能正常执行。
     * */
    return function() {
        /*
         * 修改一个变量的值，会先对这个变量进行查找。
         * 然后把找到的变量值进行修改。
         * */
        console.log(++a);
    }
}
var fn = getFn();
fn();  // 1
fn();  // 2
var fn2 = getFn();
fn2();  // 1
```    

## 检测变量作用范围
    使用这个变量,如果报错说明不在作用范围.
   
    
# 词法作用域(静态作用域)    
    变量查找方式:
        1. 访问一个变量，先在当前作用域下查找，
        2. 没有找到，就去产生当前作用域对应的函数的那个作用域中去查找，
        3. 直到全局作用域为止，如果一直没有就报错。

```javascript
var g = 123;
(function fn() {
    var a = 1;
    (function inFn() {
        var b= 10;
        console.log(a, b, g); // 全能找到
    }());
    console.log(a, b, g);     // b无法找到，报错
})();
```        


# 动态作用域  
    变量查找方式:
        1. 访问一个变量，先在当前作用域下查找，
        2. 没有找到，就去产生当前作用域的那个作用域中去查找，
        3. 直到全局作用域为止，如果一直没有就报错。
        
```javascript
function fn() {
    var p = 1;
}
(function fn2() {
    fn();
    console.log(p);
}());
```  
        
        
# 块级作用域
   
    let:  ES6新增的定义变量关键字，使用该关键字定义的变量拥有块级作用域，同时不会参与预解析;
   
```javascript
console.log(a); // 报错，不会预解析
let a = 1;
console.log(a); // 正常打印
{
    let parm = 0;
    console.log(parm); // 正常打印
}
console.log(parm);     // 报错，块的外面访问不到
for( let i = 0, len = 5; i < len; i++ ) {
    console.log(i, len);  // 正常打印
}
console.log(i, len);     // 报错，for语句中定义的变量只能在for的代码块中使用，外面使用不了
```      
    
        